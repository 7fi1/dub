enum ProgramEmailType {
  campaign
  automation
}

enum ProgramEmailStatus {
  draft
  active
  paused
  sent
}

model ProgramEmail {
  id         String             @id @default(cuid())
  programId  String
  workflowId String?            @unique
  type       ProgramEmailType
  status     ProgramEmailStatus @default(draft)
  name       String
  subject    String
  body       String             @db.Text
  deliverAt  DateTime?
  createdAt  DateTime           @default(now())
  updatedAt  DateTime           @updatedAt

  program  Program             @relation(fields: [programId], references: [id])
  workflow Workflow?           @relation(fields: [workflowId], references: [id], onDelete: Cascade)
  groups   ProgramEmailGroup[]

  @@index(programId)
}

model ProgramEmailGroup {
  id             String @id @default(cuid())
  programEmailId String
  groupId        String

  programEmail ProgramEmail @relation(fields: [programEmailId], references: [id], onDelete: Cascade)
  partnerGroup PartnerGroup @relation(fields: [groupId], references: [id], onDelete: Cascade)

  @@unique([programEmailId, groupId])
  @@index(groupId)
}
